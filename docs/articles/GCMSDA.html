<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Data analysis of GC-MS and LC-MS in Environmental Science â€¢ enviGCMS</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Data analysis of GC-MS and LC-MS in Environmental Science">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-58201304-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-58201304-1');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">enviGCMS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/GCMSDA.html">Data analysis of GC-MS and LC-MS in Environmental Science</a></li>
    <li><a class="dropdown-item" href="../articles/PooledQC.html">Pooled QC analysis</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/yufree/enviGCMS/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Data analysis of GC-MS and LC-MS in Environmental Science</h1>
                        <h4 data-toc-skip class="author">Miao Yu</h4>
            
            <h4 data-toc-skip class="date">2025-01-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/yufree/enviGCMS/blob/HEAD/vignettes/GCMSDA.Rmd" class="external-link"><code>vignettes/GCMSDA.Rmd</code></a></small>
      <div class="d-none name"><code>GCMSDA.Rmd</code></div>
    </div>

    
    
<p>Qualitative and quantitative analysis of contaminants are the core of
the Environmental Science. GC/LC-MS might be one of the most popular
instruments for such analytical methods. Previous works such as
<code>xcms</code> were developed for GC-MS data. However, such packages
have limited functions for environmental analysis. In this package. I
added functions for various GC/LC-MS data analysis purposes used in
environmental analysis. Such feature could not only reveal certain
problems, but also help the user find out the unknown patterns in the
dataset of GC/LC-MS.</p>
<div class="section level2">
<h2 id="data-analysis-for-single-sample">Data analysis for single sample<a class="anchor" aria-label="anchor" href="#data-analysis-for-single-sample"></a>
</h2>
<div class="section level3">
<h3 id="data-structure-of-gclc-ms-full-scan-mode">Data structure of GC/LC-MS full scan mode<a class="anchor" aria-label="anchor" href="#data-structure-of-gclc-ms-full-scan-mode"></a>
</h3>
<p>GC/LC is used for separation and MS is used for detection in a
GC/LC-MS system. The collected data are intensities of certain mass at
different retention time. When we perform analysis on certain column in
full scan mode, the counts of different mass were collected in each
scan. The dwell time for each scan might only last for 500ms or less.
Then the next scan begins with a different retention time. Here we could
use a matrix to stand for those data. Each column stands for each mass
and row stands for the retention time of that scan. Such matrix could be
treated as time series data. In this package, we treat such data as
<code>matrix</code> type.</p>
<p>For high-resolution MS, building such matrix is tricky. We might need
to bin the RAW data to make alignment for different scans into a matrix.
Such works could be done by <code>xcms</code>.</p>
</div>
<div class="section level3">
<h3 id="data-structure-of-gc-ms-sim-mode">Data structure of GC-MS SIM mode<a class="anchor" aria-label="anchor" href="#data-structure-of-gc-ms-sim-mode"></a>
</h3>
<p>When you perform a selected ions monitor(SIM) mode analysis, only few
mass data were collected and each mass would have counts and retention
time as a time series data. In this package, we treat such data as
<code>data.frame</code> type.</p>
</div>
<div class="section level3">
<h3 id="data-input">Data input<a class="anchor" aria-label="anchor" href="#data-input"></a>
</h3>
<p><em>Since version 0.7.4, those functions have been removed from the
package. </em></p>
<p>You could use <code>getmd</code> to import the mass spectrum data as
supported by <code>xcms</code> and get the profile of GC-MS data matrix.
<code>mzstep</code> is the bin step for mass:</p>
<pre><code><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">enviGCMS</span><span class="fu">:::</span><span class="fu"><a href="../reference/getmd.html">getmd</a></span><span class="op">(</span><span class="st">'data/data1.CDF'</span>, mzstep <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre>
<p>You could also subset the data by the mass(m/z 100-1000) or retention
time range(40-100s) in <code>getmd</code> function:</p>
<pre><code><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">enviGCMS</span><span class="fu">:::</span><span class="fu"><a href="../reference/getmd.html">getmd</a></span><span class="op">(</span><span class="va">data</span>,mzrange<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">1000</span><span class="op">)</span>,rtrange<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre>
<p>You could also combined the mass full-scan data with the same range
of retention time by <code>cbmd</code>:</p>
<pre><code><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cbmd.html">cbmd</a></span><span class="op">(</span><span class="va">data1</span>,<span class="va">data2</span>,<span class="va">data3</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="visualization-of-mass-spectrum-data">Visualization of mass spectrum data<a class="anchor" aria-label="anchor" href="#visualization-of-mass-spectrum-data"></a>
</h3>
<p>You could plot the Total Ion Chromatogram(TIC) for certain RT and
mass range.</p>
<pre><code><span><span class="fu"><a href="../reference/plottic.html">plottic</a></span><span class="op">(</span><span class="va">data</span>,rt<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.1</span>,<span class="fl">25</span><span class="op">)</span>,ms<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span></code></pre>
<p>You could use <code>plotms</code> or <code>plotmz</code> to show the
heatmap or scatter plot for LC/GC-MS data, which is very useful for
exploratory data analysis.</p>
<pre><code><span><span class="fu"><a href="../reference/plotms.html">plotms</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotmz.html">plotmz</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre>
<p>You could change the retention time into the temperature if it is a
constant speed of temperature rising process. But you need show the
temperature range.</p>
<pre><code><span><span class="fu"><a href="../reference/plott.html">plott</a></span><span class="op">(</span><span class="va">data</span>,temp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">320</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="data-analysis-for-influence-from-gc-ms">Data analysis for influence from GC-MS<a class="anchor" aria-label="anchor" href="#data-analysis-for-influence-from-gc-ms"></a>
</h3>
<p><code>enviGCMS</code> supplied many functions for decreasing the
noise during the analysis process. <code>findline</code> could be used
for find line of the boundary regression model for noise.
<code>comparems</code> could be used to make a point-to-point data
subtraction of two full-scan mass spectrum data. <code>plotgroup</code>
could be used convert the data matrix into a 0-1 heatmap according to
threshold. <code>plotsub</code> could be used to show the self
background subtraction of full-scan data. <code>plotsms</code> shows the
RSD of the intensity of full scan data. <code>plothist</code> could be
used to find the data distribution of the histogram of the intensities
of full scan data.</p>
</div>
<div class="section level3">
<h3 id="data-analysis-for-molecular-isotope-ratio">Data analysis for molecular isotope ratio<a class="anchor" aria-label="anchor" href="#data-analysis-for-molecular-isotope-ratio"></a>
</h3>
<p>Some functions could be used to calculate the molecular isotope
ratio. EIC data could be import into <code>GetIntergration</code> and
return the information of found peaks. <code>Getisotoplogues</code>
could be used to calculate the molecular isotope ratio of certain
molecular. Some shortcut function such as <code>batch</code> and
<code>qbatch</code> could be used to calculate molecular isotope ratio
for multiple and single molecular in EIC data.</p>
</div>
<div class="section level3">
<h3 id="quantitative-analysis-for-short-chain-chlorinated-paraffinssccps">Quantitative analysis for short-chain chlorinated
paraffins(SCCPs)<a class="anchor" aria-label="anchor" href="#quantitative-analysis-for-short-chain-chlorinated-paraffinssccps"></a>
</h3>
<p><code>enviGCMS</code> supply function to perform Quantitative
analysis for short-chain chlorinated paraffins(SCCPs) with Q-tof data.
Use <code>getsccp</code> to make Quantitative analysis for SCCPs.</p>
<p>If you want a graphical user interface for SCCPs analysis, a shiny
application is developed in this package. You could use
<code><a href="../reference/runsccp.html">runsccp()</a></code> to power on the application in a browser.</p>
</div>
</div>
<div class="section level2">
<h2 id="data-analysis-for-multiple-samples">Data analysis for multiple samples<a class="anchor" aria-label="anchor" href="#data-analysis-for-multiple-samples"></a>
</h2>
<p>In environmental non-target analysis, when multiple samples are
collected, problem will raise from the heterogeneity among samples. For
example, retention time would shift due to the column. In those cases,
<code>xcms</code> package could be used to get a peaks list across
samples within certain retention time and m/z. <code>enviGCMS</code>
package has some wrapped function to get the peaks list. Besides, some
specific functions such as group comparison, batch correction and
visualization are also included.</p>
<div class="section level3">
<h3 id="wrap-function-for-xcms-package">Wrap function for <code>xcms</code> package<a class="anchor" aria-label="anchor" href="#wrap-function-for-xcms-package"></a>
</h3>
<p><em>Since version 0.7.4, those functions have been removed from the
package. </em></p>
<ul>
<li><p><code>getdata</code> could be used to get the
<code>xcmsSet</code> object in one step with optimized methods</p></li>
<li><p><code>getdata2</code> could be used to get the
<code>XCMSnExp</code> object in one step with optimized methods</p></li>
<li><p><code>getmzrt</code> could get a list as <code>mzrt</code> object
with peaks list, mz, retention time and class of samples from
<code>xcmsSet</code>/<code>XCMSnExp</code> object. You could also save
related <code>xcmsSet</code> and <code>xcmsEIC</code> object for further
analysis. It also support to output the file for metaboanalyst,
xMSannotator, Mummichog pathway analysis and paired mass distance(PMD)
analysis.</p></li>
<li><p><code>getmzrtcsv</code> could read in the csv files and return a
list for peaks list as <code>mzrt</code> object</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="data-imputation-and-filtering">Data imputation and filtering<a class="anchor" aria-label="anchor" href="#data-imputation-and-filtering"></a>
</h3>
<ul>
<li><p><code>getimputation</code> could impute NA in the peaks
list.</p></li>
<li><p><code>getfilter</code> could filter the data based on row and
column index.</p></li>
<li><p><code>getdoe</code> could filter the data based on rsd and
intensity and generate group mean, standard deviation, and group
rsd.</p></li>
<li><p><code>getpower</code> could compute the power for known peaks
list or the sample numbers for each peak</p></li>
<li><p><code>getoverlappeak</code> could get the overlap peaks by mass
and retention time range for two different list objects</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="visualization-of-peaks-list-data">Visualization of peaks list data<a class="anchor" aria-label="anchor" href="#visualization-of-peaks-list-data"></a>
</h3>
<ul>
<li><p><code>plotmr</code> could plot the scatter plot for peaks list
with threshold</p></li>
<li><p><code>plotmrc</code> could plot the differences as scatter plot
for peaks list with threshold between two group of data</p></li>
<li><p><code>plotrsd</code> could plot the rsd influences of data in
different groups</p></li>
<li><p><code>gifmr</code> could plot scatter plot for peaks list and
output gif file for multiple groups</p></li>
<li><p><code>plotpca</code> could plot pca score plot</p></li>
<li><p><code>plothm</code> could plot heatmap</p></li>
<li><p><code>plotden</code> could plot density of multiple
samples</p></li>
<li><p><code>plotrla</code> could plot Relative Log Abundance (RLA)
plots</p></li>
<li><p><code>plotridges</code> could plot Relative Log Abundance Ridge
(RLAR) plots</p></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>In general, <code>enviGCMS</code> could be used to explore single
data or peaks list from GC/LC-MS and extract certain patterns in the
data with various purposes.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Miao YU.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
